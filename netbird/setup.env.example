###############################################################################
#              NETBIRD SELF-HOSTED CONFIG – GENERIC OIDC EXAMPLE             #
#               Copy this file to setup.env and adjust values.               #
###############################################################################

# -----------------------------------------------------------------------------
# Deployment mode
# -----------------------------------------------------------------------------
# - standalone           → NetBird terminates TLS itself (LetsEncrypt / certs)
# - proxy_docker         → reverse proxy in Docker (managed outside this compose)
# - proxy_external       → reverse proxy on another host/VM, NetBird exposes HTTP ports
# - proxy_docker_caddy   → reverse proxy (Caddy) included in this compose, Caddyfile is generated
NETBIRD_DEPLOYMENT_MODE="standalone"

# Docker network name used by reverse proxy (only for proxy_docker / proxy_docker_caddy)
NETBIRD_REVERSE_PROXY_NETWORK="reverse_proxy_net"

# -----------------------------------------------------------------------------
# Image tags (optional; defaults to "latest")
# -----------------------------------------------------------------------------
NETBIRD_DASHBOARD_TAG=""
NETBIRD_SIGNAL_TAG=""
NETBIRD_MANAGEMENT_TAG=""
COTURN_TAG=""
NETBIRD_RELAY_TAG=""

# -----------------------------------------------------------------------------
# Domains
# -----------------------------------------------------------------------------
# Dashboard / API domain (public)
NETBIRD_DOMAIN="netbird.example.com"

# TURN domain (optional, defaults to NETBIRD_DOMAIN)
NETBIRD_TURN_DOMAIN=""

# TURN external IP address (optional)
# If empty, configure.sh will attempt autodetection
NETBIRD_TURN_EXTERNAL_IP=""

# -----------------------------------------------------------------------------
# OIDC – GENERIC PROVIDER SETTINGS
# -----------------------------------------------------------------------------
# Well-known config URL of your OIDC provider, e.g.:
#   https://idp.example.com/.well-known/openid-configuration
NETBIRD_AUTH_OIDC_CONFIGURATION_ENDPOINT=""

# Audience required by your IdP (varies by provider)
NETBIRD_AUTH_AUDIENCE=""

# OIDC client ID + secret (secret may be empty on some providers)
NETBIRD_AUTH_CLIENT_ID=""
NETBIRD_AUTH_CLIENT_SECRET=""

# Scopes requested by NetBird
NetBird_AUTH_SUPPORTED_SCOPES="openid profile email offline_access"

# Optional: custom claim for the user identity (default = "sub")
# NETBIRD_AUTH_USER_ID_CLAIM=""

# Should NetBird use Auth0 legacy compatibility? (Only for Auth0)
NETBIRD_USE_AUTH0="false"

# Custom redirect paths (combined with NETBIRD_DOMAIN)
# Examples:
# NETBIRD_AUTH_REDIRECT_URI="/auth"
# NETBIRD_AUTH_SILENT_REDIRECT_URI="/silent-auth"
NETBIRD_AUTH_REDIRECT_URI=""
NETBIRD_AUTH_SILENT_REDIRECT_URI=""

# Prefer idToken instead of accessToken (optional)
# NETBIRD_TOKEN_SOURCE="idToken"

# -----------------------------------------------------------------------------
# DEVICE AUTHORIZATION FLOW (Optional)
# -----------------------------------------------------------------------------
NETBIRD_AUTH_DEVICE_AUTH_PROVIDER="none"
NETBIRD_AUTH_DEVICE_AUTH_CLIENT_ID=""
NETBIRD_AUTH_DEVICE_AUTH_AUDIENCE="$NETBIRD_AUTH_AUDIENCE"
NETBIRD_AUTH_DEVICE_AUTH_SCOPE="openid"
NETBIRD_AUTH_DEVICE_AUTH_USE_ID_TOKEN=false

# -----------------------------------------------------------------------------
# PKCE AUTHORIZATION (CLI)
# -----------------------------------------------------------------------------
NETBIRD_AUTH_PKCE_REDIRECT_URL_PORTS="53000"

# -----------------------------------------------------------------------------
# MANAGEMENT IDP (Generic)
# -----------------------------------------------------------------------------
# Valid options (examples): "none", "auth0", "azure", "keycloak", "zitadel"
NETBIRD_MGMT_IDP="none"

# Some IdPs require separate management client credentials
NETBIRD_IDP_MGMT_CLIENT_ID="$NETBIRD_AUTH_CLIENT_ID"
NETBIRD_IDP_MGMT_CLIENT_SECRET=""

# Additional IdP-specific settings
# Use NETBIRD_IDP_MGMT_EXTRA_* variables
# Example:
# NETBIRD_IDP_MGMT_EXTRA_ADMIN_ENDPOINT="https://idp.example.com/admin/api"
# NETBIRD_MGMT_IDP_SIGNKEY_REFRESH=false

# -----------------------------------------------------------------------------
# LetsEncrypt / Reverse Proxy
# -----------------------------------------------------------------------------
NETBIRD_DISABLE_LETSENCRYPT=false
NETBIRD_EXTERNAL_TLS_PORT=443
NETBIRD_LETSENCRYPT_EMAIL=""

# -----------------------------------------------------------------------------
# Internal ports (for proxy modes)
# -----------------------------------------------------------------------------
NETBIRD_DASHBOARD_INTERNAL_PORT=80
NETBIRD_SIGNAL_INTERNAL_PORT=10000
NETBIRD_RELAY_INTERNAL_PORT=33080
NETBIRD_MGMT_INTERNAL_PORT=33073

# -----------------------------------------------------------------------------
# Storage Backend (sqlite or postgres)
# -----------------------------------------------------------------------------
NETBIRD_STORE_CONFIG_ENGINE="sqlite"

# Use internal Postgres container? (only relevant if postgres is selected)
NETBIRD_USE_INTERNAL_POSTGRES=true

# Internal Postgres settings (if enabled; password is auto-generated if empty)
NETBIRD_POSTGRES_DB="netbird"
NETBIRD_POSTGRES_USER="netbird"
NETBIRD_POSTGRES_PASSWORD=""

# External Postgres DSN (only used when NETBIRD_USE_INTERNAL_POSTGRES=false)
NETBIRD_STORE_ENGINE_POSTGRES_DSN=""

# -----------------------------------------------------------------------------
# Extra
# -----------------------------------------------------------------------------
NETBIRD_DISABLE_ANONYMOUS_METRICS=false
NETBIRD_MGMT_DNS_DOMAIN="netbird.selfhosted"
NETBIRD_MGMT_DISABLE_DEFAULT_POLICY=false

# Relay domain & ports (leave empty for default behavior)
NETBIRD_RELAY_DOMAIN=""
NETBIRD_RELAY_PORT=""
NETBIRD_MGMT_API_PORT=""
NETBIRD_SIGNAL_PORT=""